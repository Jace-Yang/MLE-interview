# 正则表达式

正则表达式是用来描述或者匹配一系列字符串的单个字符串。

#### 1. 通用正则表达式

（1）字符匹配

| 表达式 | 作用                                                         |
| ------ | ------------------------------------------------------------ |
| \d     | 任意一个数字，0~9   中的任意一个                             |
| \w     | 任意一个字母或数字或下划线，也就是   A\~Z,a\~z,0\~9,_ 中任意一个 |
| \s     | 包括空格、制表符、换页符等空白字符的其中任意一个             |
| .      | 小数点可以匹配除了换行符（\n）以外的任意一个字符             |
| \D     | 非\d                                                         |
| \W     | 非\w                                                         |
| \S     | 非\s                                                         |

（2）次数

| 表达式 | 作用                                                         |
| ------ | ------------------------------------------------------------ |
| {n}    | 表达式重复n次，比如："\w{2}" 相当于 "\w\w"；"a{5}" 相当于 "aaaaa" |
| {m,n}  | 表达式至少重复m次，最多重复n次，比如："ba{1,3}"可以匹配 "ba"或"baa"或"baaa" |
| {m,}   | 表达式至少重复m次，比如："\w\d{2,}"可以匹配 "a12","_456","M12344"... |
| ?      | 匹配表达式0次或者1次，相当于 {0,1}，比如："a[cd]?"可以匹配 "a","ac","ad" |
| +      | 表达式至少出现1次，相当于 {1,}，比如："a+b"可以匹配 "ab","aab","aaab"... |
| *      | 表达式不出现或出现任意次，相当于 {0,}，比如：“a*b"可以匹配 "b",“aaaab"... |

（3）方括号的使用

- [] 匹配括号中的任何一个字符
  - `r[aou]t` 匹配 rat、rot、rut，不匹配 root

- [0-9] 匹配任何数字

- [a-z] 匹配a-z之间的任何字符

- [\^a-z] 匹配除了a-z之间的字符

- {i}匹配指定数目的字符
  - A[0-9]{3} 匹配 A123、A348

（4）转义字符

`\\` 表示\

`\*` 表示*

`\$` 表示 $

`\.`  表示.

（5）贪婪与懒惰

一般的正则表达式都是贪婪匹配（最长匹配）。例如表达式`a.*b`作用在字符串aabab上，匹配结果为aabab。怎么得到结果 aab 和 ab呢?这就需要懒惰匹配了。

- *? 重复任意次，但尽可能少重复 
- +? 重复1次或更多次，但尽可能少重复 
- ?? 重复0次或1次，但尽可能少重复 
- {n,m}? 重复n到m次，但尽可能少重复 
- {n,}? 重复n次以上，但尽可能少重复

（6）字符边界

| 表达式 | 作用                                                         |
| ------ | ------------------------------------------------------------ |
| ^      | 与字符串开始的地方匹配，不匹配任何字符                       |
| $      | 与字符串结束的地方匹配，不匹配任何字符                       |
| \b     | 匹配一个单词边界，也就是单词和空格之间的位置，不匹配任何字符 |

- `are you$`匹配 `how are you`, 不匹配`how old are you?`

- `^how are`匹配 `how are you`, 不匹配`how old are you`
-   `\bho\b`匹配 `ho are you`,不匹配`how old are you`



### 2. python 正则表达式

#### 2.1 查找

（1）re.match: 只匹配字符串的**开始**，如果字符串开始不符合正则表达式，则匹配失败，函数返回None；如果匹配成功，则返回一个Match。

`re.match(pattern, string, flags)`

- 第一个参数是正则表达式

- 第二个参数表示要匹配的字符串；

- 第三个参数是标致位，用于控制正则表达式的匹配方式，如：是否区分大小写，多行匹配等等。
  - re.I  表示大小写忽略
  - re.M  多行模式 使 ^ $ 匹配除了string开始结束外，还匹配一行的开始和结束
  - re.S  `.` 匹配包括‘\n’在内的任意字符，否则 `.`不包括‘\n’

（2）re.search: 在字符串内查找模式匹配,直到找到第一个匹配然后返回，如果字符串没有匹配，则返回None。

（3）re.findall：获取字符串中所有匹配的字符串，返回一个列表。re.compile把正则表达式编译成一个正则表达式对象。

```python
import re
pattern = re.compile(r'\d+')   # 查找数字
result1 = pattern.findall('runoob 123 google 456') ##['123', '456']
```

（4）re.finditer：可以获取字符串中所有匹配的字符串，返回一个迭代器。

```python
import re
 it = re.finditer(r"\d+","12a32bc43jf3") 
for match in it: 
    print (match.group())
```



分组：

```python
m = re.match('(a(b)c)d’, 'abcd')
m.group(0)   ##'abcd‘
m.group(1)   ## 'abc‘
m.group(2)   ## 'b'
```

命名分组：

```python
m = re.search(r'(?P<word>a.*?b)(ab)', 'aabab')
m.group('word') ##aab
```



#### 2.2 替换

re.sub用于**替换**字符串中的匹配项。

re.sub的函数原型为：`re.sub(replacement, string, [count = 0])`

- 第1个参数是替换后的字符串；

- 第2个参数是替换的字符串；

- 第3个参数是替换个数。默认为0，表示每个匹配项都替换。

```python
p = re.compile( '(blue|white|red)')
print p.sub( 'color', 'blue socks and red shoes') ## 把所有“blue,white,red”都替换成"color". 输出color socks and color shoes
```



#### 2.3 re.split

split 方法按照能够匹配的子串将字符串分割后返回列表，它的使用形式如下：

```python
re.split(pattern, string[, maxsplit=0, flags=0])
```

例如：

```python
import re
re.split('\W+', 'runoob, runoob, runoob.')  ##['runoob', 'runoob', 'runoob', '']
```

